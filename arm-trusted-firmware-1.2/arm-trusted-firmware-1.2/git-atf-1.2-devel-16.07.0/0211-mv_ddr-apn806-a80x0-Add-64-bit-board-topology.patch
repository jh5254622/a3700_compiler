From d68e7008c9ce51b5a2a8a83596a3b1552457f674 Mon Sep 17 00:00:00 2001
From: Victor Axelrod <victora@marvell.com>
Date: Thu, 9 Jun 2016 16:48:55 +0300
Subject: [PATCH 211/239] mv_ddr: apn806: a80x0: Add 64-bit board topology

Change-Id: I610424fa16573558c9b5cea9270bcb93c5dace7d
Signed-off-by: Victor Axelrod <victora@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/30393
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Nadav Haklai <nadavh@marvell.com>
---
 drivers/marvell/mv_ddr/apn806/mv_ddr_apn806_brd.c | 18 +++++++++++++++++-
 1 file changed, 17 insertions(+), 1 deletion(-)

diff --git a/drivers/marvell/mv_ddr/apn806/mv_ddr_apn806_brd.c b/drivers/marvell/mv_ddr/apn806/mv_ddr_apn806_brd.c
index 65ad2ac..83ca6fe 100644
--- a/drivers/marvell/mv_ddr/apn806/mv_ddr_apn806_brd.c
+++ b/drivers/marvell/mv_ddr/apn806/mv_ddr_apn806_brd.c
@@ -141,6 +141,10 @@ static struct hws_topology_map board_topology_map = {
 	{ { { {0x1, 0x0, 0, 0},					/* FIXME: change the cs mask for all 64 bit */
 	      {0x1, 0x0, 0, 0},
 	      {0x1, 0x0, 0, 0},
+	      {0x1, 0x0, 0, 0},
+	      {0x1, 0x0, 0, 0},
+	      {0x1, 0x0, 0, 0},
+	      {0x1, 0x0, 0, 0},
 	      {0x1, 0x0, 0, 0} },
 	   SPEED_BIN_DDR_2400S,		/* speed_bin */		/* TODO: double check if the speed bin is 2400S */
 	   BUS_WIDTH_8,			/* memory_width */
@@ -148,7 +152,11 @@ static struct hws_topology_map board_topology_map = {
 	   DDR_FREQ_800,		/* frequency */
 	   0, 0,			/* cas_l, cas_wl */
 	   HWS_TEMP_LOW} },		/* temperature */
-	BUS_MASK_32BIT			/* Buses mask */	/* FIXME: change to 64bit */
+#if defined(CONFIG_64BIT)
+	MV_DDR_64BIT_BUS_MASK
+#else
+	BUS_MASK_32BIT			/* Buses mask */
+#endif
 #elif defined(a80x0_cust)
 	/* Customer board with 1CS 8Gb x4 devices of Micron 2400T */
 	0x1, /* active interfaces */
@@ -156,6 +164,10 @@ static struct hws_topology_map board_topology_map = {
 	{ { { {0x1, 0x0, 0, 0},					/* FIXME: change the cs mask for all 64 bit */
 	      {0x1, 0x0, 0, 0},
 	      {0x1, 0x0, 0, 0},
+	      {0x1, 0x0, 0, 0},
+	      {0x1, 0x0, 0, 0},
+	      {0x1, 0x0, 0, 0},
+	      {0x1, 0x0, 0, 0},
 	      {0x1, 0x0, 0, 0} },
 	   SPEED_BIN_DDR_2400S,		/* speed_bin */		/* TODO: double check if the speed bin is 2400S */
 	   BUS_WIDTH_8,			/* memory_width */
@@ -163,8 +175,12 @@ static struct hws_topology_map board_topology_map = {
 	   DDR_FREQ_800,		/* frequency */
 	   0, 0,			/* cas_l, cas_wl */
 	   HWS_TEMP_LOW} },		/* temperature */
+#if defined(CONFIG_64BIT)
+	MV_DDR_64BIT_BUS_MASK
+#else
 	BUS_MASK_32BIT			/* Buses mask */	/* FIXME: change to 64bit */
 #endif
+#endif
 };
 
 struct hws_topology_map *ddr3_get_topology_map(void)
-- 
1.9.1

