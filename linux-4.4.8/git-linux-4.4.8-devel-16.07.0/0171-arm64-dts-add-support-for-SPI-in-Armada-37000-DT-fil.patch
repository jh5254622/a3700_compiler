From ccdb3c4ace7380fc52683726ffc2eb996450e0b4 Mon Sep 17 00:00:00 2001
From: Marcin Wojtas <mw@semihalf.com>
Date: Mon, 15 Feb 2016 02:56:55 +0100
Subject: [PATCH 171/538] arm64: dts: add support for SPI in Armada 37000 DT
 files

Change-Id: Id56974e29c587efe4cac9f5eb80da403d4afc819
Signed-off-by: Marcin Wojtas <mw@semihalf.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/27687
Reviewed-by: Nadav Haklai <nadavh@marvell.com>
Tested-by: Nadav Haklai <nadavh@marvell.com>
---
 arch/arm64/boot/dts/marvell/armada-3720-db.dts | 21 +++++++++++++++++++++
 arch/arm64/boot/dts/marvell/armada-37xx.dtsi   | 13 +++++++++++++
 2 files changed, 34 insertions(+)

diff --git a/arch/arm64/boot/dts/marvell/armada-3720-db.dts b/arch/arm64/boot/dts/marvell/armada-3720-db.dts
index 284d639..52f5e5e 100644
--- a/arch/arm64/boot/dts/marvell/armada-3720-db.dts
+++ b/arch/arm64/boot/dts/marvell/armada-3720-db.dts
@@ -63,6 +63,27 @@
 
 	soc {
 		internal-regs {
+			spi0: spi@10600 {
+				status = "okay";
+
+				spi-flash@0 {
+					#address-cells = <1>;
+					#size-cells = <1>;
+					compatible = "jedec,spi-nor";
+					reg = <0>; /* Chip select 0 */
+					spi-max-frequency = <104000000>;
+
+					partition@0 {
+						label = "U-boot";
+						reg = <0 0x100000>;
+					};
+					partition@100000 {
+						label = "Linux";
+						reg = <0x100000 0x300000>;
+					};
+				};
+			};
+
 			/*
 			* Exported on the micro USB connector CON32
 			* through an FTDI
diff --git a/arch/arm64/boot/dts/marvell/armada-37xx.dtsi b/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
index 16a7f3c..91f7e01 100644
--- a/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
+++ b/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
@@ -98,6 +98,19 @@
 			/* 32M internal register @ 0xd000_0000 */
 			ranges = <0x0 0x0 0xd0000000 0x2000000>;
 
+			spi0: spi@10600 {
+				compatible = "marvell,armada3700-spi";
+				reg = <0x10600 0xa00>;
+				#address-cells = <1>;
+				#size-cells = <0>;
+				cell-index = <0>;
+				clock-frequency = <160000>;
+				max-frequency = <40000>;
+				fifo-mode;
+				interrupts = <0 0 4>;
+				status = "disabled";
+			};
+
 			uart0: serial@12000 {
 				compatible = "marvell,armada-3700-uart";
 				reg = <0x12000 0x400>;
-- 
1.9.1

