From c5b0f3b1981beb9f81eba66ffa9b79578981bc7f Mon Sep 17 00:00:00 2001
From: Yuval Caduri <cyuval@marvell.com>
Date: Wed, 6 Apr 2016 03:23:30 +0300
Subject: [PATCH 307/538] mvpp2x: fix, update mru correctly, for 10G MACs.

Change-Id: Iaccf6e11f2b326596607eaf98185cac136382f8d
Signed-off-by: Yuval Caduri <cyuval@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/28814
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Hanna Hawa <hannah@marvell.com>
---
 drivers/net/ethernet/marvell/mvpp2x/mv_pp2x_main.c | 18 ++++++++++++++++--
 1 file changed, 16 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/marvell/mvpp2x/mv_pp2x_main.c b/drivers/net/ethernet/marvell/mvpp2x/mv_pp2x_main.c
index b64f058..2cfd368 100644
--- a/drivers/net/ethernet/marvell/mvpp2x/mv_pp2x_main.c
+++ b/drivers/net/ethernet/marvell/mvpp2x/mv_pp2x_main.c
@@ -2574,8 +2574,22 @@ void mv_pp2x_start_dev(struct mv_pp2x_port *port)
 #endif /* DEV_NETMAP */
 	if (FPGA || port->priv->pp2_version == PPV21)
 		mv_pp21_gmac_max_rx_size_set(port);
-	else
-		mv_gop110_gmac_max_rx_size_set(gop, mac_num, port->pkt_size);
+	else {
+		switch (mac->phy_mode) {
+		case PHY_INTERFACE_MODE_RGMII:
+		case PHY_INTERFACE_MODE_SGMII:
+		case PHY_INTERFACE_MODE_QSGMII:
+			mv_gop110_gmac_max_rx_size_set(gop, mac_num, port->pkt_size);
+		break;
+		case PHY_INTERFACE_MODE_XAUI:
+		case PHY_INTERFACE_MODE_RXAUI:
+		case PHY_INTERFACE_MODE_KR:
+			mv_gop110_xlg_mac_max_rx_size_set(gop, mac_num, port->pkt_size);
+		break;
+		default:
+		break;
+		}
+	}
 	mv_pp2x_txp_max_tx_size_set(port);
 
 	mv_pp2x_port_napi_enable(port);
-- 
1.9.1

