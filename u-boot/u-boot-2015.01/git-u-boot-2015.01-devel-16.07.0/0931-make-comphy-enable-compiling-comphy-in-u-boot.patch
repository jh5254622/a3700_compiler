From 780c17deb53603624158a2f1f875d6da652097d2 Mon Sep 17 00:00:00 2001
From: Yehuda Yitschak <yehuday@marvell.com>
Date: Wed, 9 Mar 2016 13:08:59 +0200
Subject: [PATCH 0931/1240] make: comphy: enable compiling comphy in u-boot

Change-Id: I9ede1e8ea0513c5cd78bcc0c3f7af4ade1d1efde
Signed-off-by: Yehuda Yitschak <yehuday@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/28138
Reviewed-by: Haim Boot <hayim@marvell.com>
Reviewed-by: Kostya Porotchkin <kostap@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
---
 Makefile             | 1 +
 drivers/phy/Kconfig  | 1 -
 drivers/phy/Makefile | 4 ++--
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/Makefile b/Makefile
index bb0d37a..6e8475a 100644
--- a/Makefile
+++ b/Makefile
@@ -639,6 +639,7 @@ libs-y += drivers/usb/musb/
 libs-y += drivers/usb/musb-new/
 libs-y += drivers/usb/phy/
 libs-y += drivers/usb/ulpi/
+libs-y += drivers/phy/
 libs-y += common/
 libs-$(CONFIG_API) += api/
 libs-$(CONFIG_HAS_POST) += post/
diff --git a/drivers/phy/Kconfig b/drivers/phy/Kconfig
index 01cab9f..4240028 100644
--- a/drivers/phy/Kconfig
+++ b/drivers/phy/Kconfig
@@ -1,6 +1,5 @@
 config MVEBU_COMPHY_SUPPORT
 	bool "ComPhy SerDes driver"
-	depends on SPL
 	default n
 	help
 	  Choose this option to add support
diff --git a/drivers/phy/Makefile b/drivers/phy/Makefile
index 3730f03..286c2b5 100644
--- a/drivers/phy/Makefile
+++ b/drivers/phy/Makefile
@@ -1,5 +1,5 @@
-obj-y += comphy_core.o
-obj-y += comphy_mux.o
+obj-$(CONFIG_MVEBU_COMPHY_SUPPORT) += comphy_core.o
+obj-$(CONFIG_MVEBU_COMPHY_SUPPORT) += comphy_mux.o
 obj-$(CONFIG_TARGET_ARMADA_38X) += comphy_a38x.o
 obj-$(CONFIG_TARGET_ARMADA_38X) += comphy_a38x_pcie_config.o
 obj-$(CONFIG_TARGET_ARMADA_8K) += comphy_ap806_z1.o
-- 
1.9.1

